<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · LinearNoiseApproximation.jl</title><meta name="title" content="Home · LinearNoiseApproximation.jl"/><meta property="og:title" content="Home · LinearNoiseApproximation.jl"/><meta property="twitter:title" content="Home · LinearNoiseApproximation.jl"/><meta name="description" content="Documentation for LinearNoiseApproximation.jl."/><meta property="og:description" content="Documentation for LinearNoiseApproximation.jl."/><meta property="twitter:description" content="Documentation for LinearNoiseApproximation.jl."/><meta property="og:url" content="https://xiaomingfu2013.github.io/LinearNoiseApproximation.jl/"/><meta property="twitter:url" content="https://xiaomingfu2013.github.io/LinearNoiseApproximation.jl/"/><link rel="canonical" href="https://xiaomingfu2013.github.io/LinearNoiseApproximation.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>LinearNoiseApproximation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Brief-introduction-to-linear-noise-approximation"><span>Brief introduction to linear noise approximation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="PredatorPreyTutorial/">Tutorial</a></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/xiaomingfu2013/LinearNoiseApproximation.jl/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="LinearNoiseApproximation"><a class="docs-heading-anchor" href="#LinearNoiseApproximation">LinearNoiseApproximation</a><a id="LinearNoiseApproximation-1"></a><a class="docs-heading-anchor-permalink" href="#LinearNoiseApproximation" title="Permalink"></a></h1><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;LinearNoiseApproximation&quot;)
using LinearNoiseApproximation</code></pre><p>This package provides a numerical method of applying linear noise approximation (LNA) to a given reaction system using <a href="https://github.com/SciML/Catalyst.jl">Catalyst</a>. The derived expanded system can be solved using <a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl">DifferentialEquations.jl</a>.</p><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><h3 id="Reaction-network-with-system-size-Ω"><a class="docs-heading-anchor" href="#Reaction-network-with-system-size-Ω">Reaction network with system size Ω</a><a id="Reaction-network-with-system-size-Ω-1"></a><a class="docs-heading-anchor-permalink" href="#Reaction-network-with-system-size-Ω" title="Permalink"></a></h3><p>Suppose we have a reaction network</p><pre><code class="language-julia hljs">rn = @reaction_network TwoStage begin
    @parameters  v0 v1 d0 d1 Ω
    @species M(t) P(t)
    v0*Ω, ∅ --&gt; M
    v1, M --&gt; M + P
    d0, M --&gt; ∅
    d1, P --&gt; ∅
end</code></pre><p>Here the system size <code>Ω</code> is integrated in the system (propensities), you can simply obtain the LNA system by calling</p><pre><code class="language-julia hljs">LNAsys = LNASystem(rn)</code></pre><p>then solving the LNA by</p><pre><code class="language-julia hljs">@variables v0, v1, d0, d1, Ω
rates = [v0=&gt;4.0,v1=&gt;10.0,d0=&gt;1.0,d1=&gt;1.0,Ω=&gt;5.0]
tspan = (0.0, 20.0)
u0 =[0, 0] # initial condition for M and P
prob = ODEProblem(LNAsys, u0, tspan, rates)
sol = solve(prob,Vern7(),abstol=1e-7, saveat =1.0)</code></pre><h2 id="Brief-introduction-to-linear-noise-approximation"><a class="docs-heading-anchor" href="#Brief-introduction-to-linear-noise-approximation">Brief introduction to linear noise approximation</a><a id="Brief-introduction-to-linear-noise-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Brief-introduction-to-linear-noise-approximation" title="Permalink"></a></h2><p>Linear noise approximation (LNA) is a moment-based approximation method for stochastic chemical kinetics <a href="#1">[1]</a>. A general chemical kinetics reaction can be described as follows: given a set of chemical species <span>$X_{i}, i = 1, \ldots, N$</span>, we define <span>$R$</span> chemical reactions by the notation</p><p class="math-container">\[\begin{equation}
        k_r:\sum_{i=1}^{N}s_{ir}X_{i} \rightarrow \sum_{i=1}^{N}s&#39;_{ir}X_{i}, \tag{1}
\end{equation}\]</p><p>where the stoichiometric coefficients <span>$s_{ir}$</span> and <span>$s&#39;_{ir}$</span> are non-negative integer numbers denoting the numbers of reactant and product molecules, respectively. The quantity <span>$k_r$</span> in Equation (1) is called the reaction rate constant of the <span>$r$</span>-th reaction. Classically, the dynamics of a chemical reaction system as in Equation (1) is modelled by the law of mass action. The law of mass action states that the rate of a reaction is proportional to the product of the concentrations of reactant molecules, which lead to the following rate equations as:</p><p class="math-container">\[\begin{equation}
    \frac{\mathrm{d}}{\mathrm{dt}} \phi_i = \sum_{r=1}^{R} S_{ir} g_r(\boldsymbol{\phi}), \tag{2}
\end{equation}\]</p><p>where <span>$\phi_i$</span> is the concentration of species <span>$X_i$</span>, </p><p class="math-container">\[\boldsymbol{S} = \{S_{ir}\}_{N\times R},\; S_{ir}=s&#39;_{ir} - s_{ir},\; i=1,\ldots,N,\; r=1,\ldots,R \notag\]</p><p>is the stoichiometric matrix, and </p><p class="math-container">\[g_r(\boldsymbol{\phi}) = k_r \prod_{i=1}^{N} \phi_i^{s_{ir}}, \]</p><p>is the rate of the <span>$r$</span>-th reaction. </p><p>However, the law of mass action is only valid when the number of molecules is large. When the number of molecules is small, System (1) can instead be modelled by a continuous-time Markov jump process to study the probability of the system being in a particular state at a given time. The dynamics of such a system can be described by the chemical master equation (CME) <a href="#2">[2]</a>:</p><p class="math-container">\[\begin{equation}
    \begin{aligned}
        \frac{\mathrm{d}}{\mathrm{dt}} P(\boldsymbol{n}, t) = \sum_{r=1}^{R} f_r(\boldsymbol{n} - \mathbf{S}_r, t) P(\boldsymbol{n} - \mathbf{S}_r, t) - \sum_{r=1}^{R} f_r(\boldsymbol{n}, t) P(\boldsymbol{n}, t), \notag
    \end{aligned}
\end{equation}\]</p><p>where <span>$P(\boldsymbol{n}, t)$</span> is the probability of the system being in state <span>$\boldsymbol{n}$</span> at time <span>$t$</span>, </p><p class="math-container">\[f_r(\boldsymbol{n}, t) = k_r\Omega \prod_{i=1}^{N} \frac{n_i!}{(n_i-s_{ir})!\Omega^{s_{ir}}} \]</p><p>is the propensity function of reaction <span>$r$</span> at state <span>$\boldsymbol{n}$</span>, and <span>$\mathbf{S}_r$</span> is the stoichiometric vector of reaction <span>$r$</span>, <span>$\Omega$</span> is the system size (or volume of the system).</p><p>The chemical master equation is written directly from the rate constants and stoichiometries of all the elementary reactions of a chemical system, but neither analytical nor numerical solutions are in general available. Fortunately, the chemical master equation can often be simplified in a linear noise approximation. Linear noise approximation is an expansion of the CME taking the inverse system size <span>$1/\Omega$</span> as the perturbed variable, which is originally developed by <a href="#3">[3]</a>. The idea is to separate concentrations into a deterministic part, given by the solution of the deterministic rate equations, and a part describing the fluctuations about the deterministic mean</p><p class="math-container">\[\frac{n_i}{\Omega} = \phi_i  + \Omega^{-1/2} \epsilon_i,\]</p><p>where <span>$\phi_i$</span> is the solution of the deterministic rate equations (2), and <span>$\epsilon_i$</span> represents fluctuations about the deterministic mean. Define <span>$\boldsymbol{\Sigma}=\left(\epsilon_{ij}\right)_{N\times N}$</span> to be the covariance matrix of the fluctuations, the linear noise approximation is given by:</p><p class="math-container">\[\begin{equation}
    \partial_t \boldsymbol{\Sigma} = \mathbf{A} \boldsymbol{\Sigma} + \boldsymbol{\Sigma} \mathbf{A}^T +  \Omega^{-1} \mathbf{B}, \tag{3}
\end{equation}\]</p><p>where <span>$\mathbf{A}=\mathbf{A}(\boldsymbol{\phi}),\, \mathbf{B}=\mathbf{B}(\boldsymbol{\phi})$</span> both depend on the solution <span>$\boldsymbol{\phi}$</span> of the rate equation \eqref{eq:rate_equations}, which are defined by </p><p class="math-container">\[ \mathbf{A} = \left(A_{ij}\right)_{N\times N}, A_{ij}=\sum_{r=1}^{R} S_{ir}\partial_{\phi_j}g_r(\boldsymbol{\phi}),\]</p><p>as the Jacobian matrix of the deterministic rate equations, and </p><p class="math-container">\[\mathbf{B} =\left(B_{ij}\right)_{N\times N}, B_{ij} = \sum_{r=1}^{R} S_{ir}S_{jr}g_r(\boldsymbol{\phi}).\]</p><p>In this formulation, the LNA allows for analytical solutions that are locally valid close to macroscopic trajectories (solution of the rate equations) of the system. We refer to the review paper <a href="#2">[2]</a> for more details on the CME and LNA.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] Nicolaas Godfried van Kampen. The Expansion of the Master Equation. John Wiley &amp; Sons, Inc., 2007. </p><p>[2] David Schnoerr, Guido Sanguinetti, and Ramon Grima. Approximation and inference methods for stochastic biochemical kinetics — a tutorial review (2017). Journal of Physics A: Mathematical and Theoretical, 50(9):093001.</p><p>[3] Nicolaas Godfried van Kampen. Stochastic Processes in Physics and Chemistry, volume 1. Elsevier, 1992.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="PredatorPreyTutorial/">Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 5 February 2024 10:12">Monday 5 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
